---
layout:     post
title:      "python爬虫 JS逆向过程"
subtitle:   
date:       2020-12-09
author:     胖胖很瘦
thumbnail:  /images/0e503814/thumbnail.png
catalog: true
categories: 爬虫之路
original_url: https://mp.weixin.qq.com/s/bFlM7NoKIzkUhUMjXJY2Cw
tags:
    - 爬虫之路
---

**目标地址**

这篇来讲讲逆向破解js的方法,  先拿美团外卖的请求参数, X-FOR-WITH 练练手

请求地址:

    https://h5.waimai.meituan.com/waimai/mindex/home

**直接开始**

打开Chrom,  打开控制台, 查看请求

![](/images/0e503814/1.png)

发现需要解密的参数: **X-FOR-WITH, openh5\_uuid(uuid), \_token**

以X-FOR-WITH为例

按照正常来说, Ctrl + f打开搜索, 粘贴X-FOR-WITH, 应该能找到相关的js文件, 然后就直接会找到加密的地方, but并没有发现有关的js文件

![](/images/0e503814/2.png)

接下来使用杀手锏 打断点 

    **选择url包含food的请求**

再次刷新页面,  请求页面会中断, 然后在一步步往下来

![](/images/0e503814/3.png)

找了好几遍也没找到, 在哪里生成的X-FOR-WITH, 什么时候给带上的

从头再来一遍

突然发现, 在断点之前还有一步, 进到这个函数里看看

![](/images/0e503814/4.png)

果然, 发现这里有参数生成, 但是并不知道是什么

![](/images/0e503814/5.png)

点击\_()函数, 接着跳到函数这里

![](/images/0e503814/6.png)

 不过这看着也不像呀, 直接复制到console, 调用, 先解出来

![](/images/0e503814/7.png)

哈哈哈哈哈~, 果然就是它, 接下来, 就要解密了

首先看一下, 要想解密, 最好的方式就是先看一看, 是怎么加密的, 接着来

![](/images/0e503814/8.png)

 然后就看到了这一大堆

![](/images/0e503814/9.png)

进到cbc函数里, 瞅一瞅

![](/images/0e503814/10.png)

这不就是AES加密吗?

先去在线解密网站试一试

    http://tool.chacuo.net/cryptaes

还差一个解密密码, 打上断点

![](/images/0e503814/11.png)

这个t应该就是密码, 走试一试

![](/images/0e503814/12.png)

✌️, 成功解密X-FOR-WITH参数

接下来使用python实现一下

![](/images/0e503814/13.png)X-FOR-WITH 这个参数就解密成功了

这个应该是最难的一个参数, 其它参数, 打开chrom调试, 一下就看明白了~

最重要的是学方法!!!

**小技巧**

点击这里, 可以直接格式化js哦!!!

![](/images/0e503814/14.png)

![](/images/0e503814/15.png)