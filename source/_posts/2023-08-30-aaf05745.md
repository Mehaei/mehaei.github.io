---
layout:     post
title:      "python之生成带背景的词云图(附源码)"
subtitle:   
date:       2023-08-30
author:     胖胖很瘦
thumbnail:  /images/aaf05745/thumbnail.png
catalog: true
categories: python杂谈
original_url: https://mp.weixin.qq.com/s/dLh2BWpdAbAYLC6-qGsVeg
tags:
    - python杂谈
    - python使用小技巧
---

![](/images/aaf05745/1.png)

**1**

**所需模块**

jieba: 中文分词库

pillow: 用于处理图像的Python库

wordcloud: 词云图模块

matplotlib: 用于绘制图表和可视化

numpy: 用于科学计算和数值操作的Python库

**2**

**模块安装**

pip3.7 install wordcloud

pip3.7 install pillow

pip3.7 install matplotlib

pip3.7 install jieba

pip3.7 install numpy

> 一般报错情况下, 可以通过升级包解决
>
> pip3.7 install -U 包名

**3**

**本地测试版本**

numpy                    1.19.4

jieba                       0.42.1

matplotlib              3.5.3

wordcloud              1.9.2

Pillow                     9.5.0

**4**

**源码**

废话就不说了, 直接上源码, 把源码简单的封装了一下, 可以直接CV使用

# -\*- coding: utf-8 -\*-  
# @Author: Mehaei  
# @Date: 2023-08-29 20:23:38  
# @Last Modified by: Mehaei  
# @Last Modified time: 2023-08-30 20:31:54  
# 导入需要使用的模块  
import matplotlib.pyplot as plt  
import jieba  
import wordcloud  
from wordcloud import ImageColorGenerator  
import numpy as np  
from PIL import Image  
  
  
class genCordCloudPic(object):  
    """  
    生成词云图类  
    """  
    def \_\_init\_\_(self, ftext, fbg=None, fsave="wordcloud.png"):  
        """  
        :param ftext: 文本文件路径  
        :param fbg: 背景图片路径  
        :param fsave: 词云图片保存路径  
        """  
        self.ftext = ftext  
        self.fbg = fbg  
        self.fsave = fsave  
  
    def getWord(self):  
        """  
        读取文本文件  
        """  
        with open(self.ftext, 'r+') as f:  
            text = f.read()  
        cut\_text = jieba.cut(text)  
        return ' '.join(cut\_text)  
  
    def save\_pic(self, use\_bg\_color=False, \*\*wordcloud\_kwargs):  
        """  
        保存词云图  
        :param use\_bg\_color: 使用背景图片颜色渲染词云图的颜色  
        """  
        word = self.getWord()  
        if not word:  
            raise ValueError("分词结果为空")  
        if not self.fbg:  
            raise ValueError("背景图片为空")  
        pic = np.array(Image.open(self.fbg))  
        # 生成图片颜色中的颜色  
        image\_colors = ImageColorGenerator(pic)  
        wd = wordcloud.WordCloud(  
            mask=pic,  
            font\_path='97txj03p17q39w692ecpjely52o1v6z9.ttf',  
            background\_color='white',  
            max\_font\_size=100,  
            scale=2,  
            max\_words=500,  
            \*\*wordcloud\_kwargs  
        ).generate(word)  
        if use\_bg\_color:  
            wd.recolor(color\_func=image\_colors)  
        plt.imshow(wd, interpolation='bilinear')  
        # 关闭显示x轴、y轴下标  
        plt.axis('off')  
        plt.show()  
        wd.to\_file(self.fsave)

![](/images/aaf05745/2.png)

**5**

**使用方法**

```
# 生成随机颜色的图片  
# gccp = genCordCloudPic("text.txt", "goutou.png", "random_color.png")  
# gccp.save_pic()  
  
  
# 生成与背景图片颜色一致的图片  
gccp = genCordCloudPic("text.txt", "goutou.png", "bg_color.png")  
gccp.save_pic(use_bg_color=True)
```

**6**

**效果图**

背景图片

![](/images/aaf05745/3.png)

随机颜色词云图

![](/images/aaf05745/4.png)

使用背景图片颜色的词云图

![](/images/aaf05745/5.png)

> 注意: 应尽量使用白色背景的图片, 当生成的词云图不协调时, 可以调整字体大小或词语个数 等参数来优化词云图, 使用中文做词云图时, 应指定字体文件, 否则会出现方格的情况

**7**

**其它常用参数**

wordcloud.WordCloud 类是用于生成词云图像的主要类常用参数及示例

1. width 和 height: 指定生成词云的图像宽度和高度。

示例: **WordCloud(width=800, height=400)**

2. background\_color: 指定词云的背景颜色。

示例: **WordCloud(background\_color='white')**

3. mask: 用于指定词云的形状，可以是一个图像或图像的路径。

示例: **WordCloud(mask=mask\_image)**

4. font\_path: 指定生成词云时使用的字体文件路径，用于显示中文字符。

示例: **WordCloud(font\_path='your\_font\_file.ttf')**

5. max\_words: 指定最大显示的单词数量。

示例: **WordCloud(max\_words=100)**

6. stopwords: 设置要过滤的停用词列表，这些词不会在词云中显示。

示例: **WordCloud(stopwords=['and', 'the', 'in'])**

7. collocations: 是否考虑词组搭配，默认为 True。

示例: **WordCloud(collocations=False)**

8. prefer\_horizontal: 设置词云中词语的方向，True 为水平，False 为垂直。

示例: **WordCloud(prefer\_horizontal=True)**

9. minfontsize 和 maxfontsize: 设置词云中单词的最小和最大字体大小。

示例: **WordCloud(min\_font\_size=10, max\_font\_size=50)**

10. background\_color: 设置词云图像的背景颜色。

示例: **WordCloud(background\_color='white')**

11. random\_state: 设置随机种子，保证每次生成的词云图像是一致的。

示例: **WordCloud(random\_state=42)**

更多参数, 参考官方文档

> https://amueller.github.io/word\_cloud/generated/wordcloud.WordCloud.html#wordcloud.WordCloud

**8**

**完整项目地址**

> https://github.com/Mehaei/wordcloud

精彩推荐

[python之异步函数添加装饰器](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247487403&idx=1&sn=a117fe16090bc37749c759618b495841&chksm=fa3511a1cd4298b71c4632519c62b329839659718657aac417e9f37f184e776eb53c1a3dfc3d&scene=21#wechat_redirect)

[python之PDF提取文字(超级简单)](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247487385&idx=1&sn=821dcdec98fc6057959cdc0fa6f0a0e5&chksm=fa351193cd4298852a1aa64c9425369afba06a6e95b33f985b295d51b7f07c2f629d6b72421f&scene=21#wechat_redirect)

[喝酒摇骰子重启人生等微信小程序源码分享](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247487031&idx=2&sn=bcefa1cfb4d785ae7085638329ae0156&chksm=fa35103dcd42992b3dc861c25efefde5c54103e0afbfc09d9c11b2bf8a80f53686c204333a90&scene=21#wechat_redirect)

[使用python selenium解决谷歌验证码(reCAPTCHA)](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247486700&idx=1&sn=e652ef969790b11797d804d39729bc80&chksm=fa3512e6cd429bf0749970c7afcc145e54fe5feae0b939390ce1a673a3de341f20868c18d41a&scene=21#wechat_redirect)