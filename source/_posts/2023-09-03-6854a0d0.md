---
layout:     post
title:      "python之logging模块的配置和使用"
subtitle:   
date:       2023-09-03
author:     胖胖很瘦
thumbnail:  /images/6854a0d0/thumbnail.png
catalog: true
categories: python
original_url: https://mp.weixin.qq.com/s/vGNjh4F7e6bK9AGHpVRtPA
tags:
    - python
    - 配置文件
---

![](/images/6854a0d0/1.png)

> 1
>
> 开始吧!

还是不想说太多的话, 这篇主要写一下logging如何使用, 及日志配置文件, 封装日志模块, 多个文件使用日志对象. 关于logging模块的详细参数介绍和使用请看官网

> https://docs.python.org/3/library/logging.html?highlight=logging#module-logging

> 2
>
> **************简单使用日志模块**************

# -\*- coding: utf-8 -\*-  
# @Author: Mehaei  
# @Date: 2023-09-03 00:58:01  
# @Last Modified by: Mehaei  
# @Last Modified time: 2023-09-03 00:58:15  
import logging  
  
logging.debug("test debug")  
logging.info("test info")  
logging.warning("test warning")  
logging.error("test error")  
logging.critical("test critical")  
  
"""  
输出  
WARNING:root:test warning  
ERROR:root:test error  
CRITICAL:root:test critical  
[Finished in 0.1s]  
"""

debug和info没有输出日志, 是因为日志等级默认为warning, 将日志输出等级改为debug, 随便修改输出日志的格式

修改配置文件代码为

# -\*- coding: utf-8 -\*-  
# @Author: Mehaei  
# @Date: 2023-09-03 00:58:01  
# @Last Modified by: Mehaei  
# @Last Modified time: 2023-09-03 01:07:55  
import logging  
  
FORMAT = "%(asctime)s %(name)s %(filename)s[%(lineno)d] %(funcName)s %(levelname)s %(message)s"  
logging.basicConfig(format=FORMAT, level=logging.DEBUG)  
logging.debug("test debug")  
logging.info("test info")  
logging.warning("test warning")  
logging.error("test error")  
logging.critical("test critical")  
  
"""  
输出  
2023-09-03 01:07:48,140 root short\_use.py[11] <module> DEBUG test debug  
2023-09-03 01:07:48,140 root short\_use.py[12] <module> INFO test info  
2023-09-03 01:07:48,140 root short\_use.py[13] <module> WARNING test warning  
2023-09-03 01:07:48,140 root short\_use.py[14] <module> ERROR test error  
2023-09-03 01:07:48,140 root short\_use.py[15] <module> CRITICAL test critical  
[Finished in 0.1s]  
"""

这样就实现了最最基本的自定义配置文件等级和格式

> 3
>
> **************更高级的日志模块**************

配置文件参数及格式可以看官网, 这是我写好的配置文件

支持输出到控制台, 和文件中, 也可以同时输出

下面写一个可以在多个文件中使用的logger对象, 其实就是封装一下

log.conf 配置文件

[loggers]  
keys=root,debug,crawler  
  
[handlers]  
keys=rotateFileHandler,consoleHandler  
  
[formatters]  
keys=simpleFormatter  
  
[logger\_root]  
level=DEBUG  
handlers=rotateFileHandler,consoleHandler  
  
[logger\_debug]  
level=DEBUG  
handlers=consoleHandler  
qualname=debug  
propagate=0  
  
[logger\_crawler]  
level=DEBUG  
handlers=rotateFileHandler  
qualname=crawler  
propagate=0  
  
[handler\_consoleHandler]  
class=StreamHandler  
args=(sys.stdout,)  
level=DEBUG  
formatter=simpleFormatter  
  
[handler\_rotateFileHandler]  
class=handlers.RotatingFileHandler  
args=('%(log\_path)s/log', 'a', 1024 \* 1024 \* 10, 1, 'utf8')  
level=DEBUG  
formatter=simpleFormatter  
  
[formatter\_simpleFormatter]  
format=%(asctime)s %(name)s %(filename)s:%(funcName)s:%(lineno)d %(levelname)s %(message)s

![](/images/6854a0d0/2.png)

logger.py 文件

# -\*- coding: utf-8 -\*-  
# @Author: Mehaei  
# @Date: 2023-09-03 00:31:46  
# @Last Modified by: Mehaei  
# @Last Modified time: 2023-09-03 09:42:14  
import os  
import logging  
import logging.config  
  
  
def get\_logger(name, plog\_conf="log.conf", write\_log\_path="./log"):  
    """  
    :param name: logger name  
    :param plog\_conf: logging config file path  
    :param write\_log\_path: write log file path  
    """  
    if not os.path.exists(write\_log\_path):  
        os.mkdir(write\_log\_path)  
    logging.config.fileConfig(plog\_conf, disable\_existing\_loggers=False, defaults={"log\_path": write\_log\_path})  
    logger = logging.getLogger(name)  
    return logger  
  
  
  
if \_\_name\_\_ == "\_\_main\_\_":  
    # 只输出到控制台  
    log = get\_logger("debug")  
    # # 只输出到文件  
    # log = get\_logger("crawler")  
    # # 同时输出到控制台和文件  
    # log = get\_logger("root")  
    log.debug("test debug")  
    log.info("test info")  
    log.warning("test warning")  
    log.error("test error")  
    log.critical("test critical")  
  
  
"""  
输出  
2023-09-03 09:44:38,481 debug logger.py:<module>:32 DEBUG test debug  
2023-09-03 09:44:38,481 debug logger.py:<module>:33 INFO test info  
2023-09-03 09:44:38,481 debug logger.py:<module>:34 WARNING test warning  
2023-09-03 09:44:38,481 debug logger.py:<module>:35 ERROR test error  
2023-09-03 09:44:38,481 debug logger.py:<module>:36 CRITICAL test critical  
[Finished in 0.1s]  
"""

> 4
>
> **************其它文件导入使用**************

# -\*- coding: utf-8 -\*-  
# @Author: Mehaei  
# @Date: 2023-09-03 09:42:45  
# @Last Modified by: Mehaei  
# @Last Modified time: 2023-09-03 09:43:22  
from logger import get\_logger  
  
log = get\_logger("debug")  
  
log.debug("test debug")  
log.info("test info")  
log.warning("test warning")  
log.error("test error")  
log.critical("test critical")  
  
"""  
输出  
2023-09-03 09:43:22,801 debug crawler.py:<module>:10 DEBUG test debug  
2023-09-03 09:43:22,801 debug crawler.py:<module>:11 INFO test info  
2023-09-03 09:43:22,801 debug crawler.py:<module>:12 WARNING test warning  
2023-09-03 09:43:22,801 debug crawler.py:<module>:13 ERROR test error  
2023-09-03 09:43:22,801 debug crawler.py:<module>:14 CRITICAL test critical  
[Finished in 0.1s]  
"""

快乐的时光总是短暂的, 下次见~

今日推荐

[python之configparser配置文件解析器](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247487433&idx=1&sn=9f905a6bed760d666ef85e187bfc3537&chksm=fa3511c3cd4298d5ecf6322b7284052ef7035f8b5e3c861a3ab5b615a0b773683547b378c1d6&scene=21#wechat_redirect)

[python之生成带背景的词云图(附源码)](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247487421&idx=1&sn=f9c214ee09ed53e623bfaca94e19ec4c&chksm=fa3511b7cd4298a1a784c8a4e6848a1f99716851275959ffd4686e9ec34b6855cdf85e49fb19&scene=21#wechat_redirect)

[python之异步函数添加装饰器](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247487403&idx=1&sn=a117fe16090bc37749c759618b495841&chksm=fa3511a1cd4298b71c4632519c62b329839659718657aac417e9f37f184e776eb53c1a3dfc3d&scene=21#wechat_redirect)

[python之PDF提取文字(超级简单)](http://mp.weixin.qq.com/s?__biz=MzUyMzk3OTYyMQ==&mid=2247487385&idx=1&sn=821dcdec98fc6057959cdc0fa6f0a0e5&chksm=fa351193cd4298852a1aa64c9425369afba06a6e95b33f985b295d51b7f07c2f629d6b72421f&scene=21#wechat_redirect)

一直在努力, 记得点个在看哦!