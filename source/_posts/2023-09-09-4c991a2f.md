---
layout:     post
title:      "python之redis基本操作及设置键过期时间"
subtitle:   
date:       2023-09-09
author:     胖胖很瘦
thumbnail:  /images/4c991a2f/thumbnail.png
catalog: true
categories: 微信公众号
original_url: https://mp.weixin.qq.com/s/nvKzEmOc9ohp0Yvt-usQ1g
tags:
    - Python
---

![](/images/4c991a2f/1.png)

**不算废话**

redis在项目开发中通常会用来做缓存数据库, 用来缓存频繁读取的数据. 往往有些时候, 需要设置键自动删除, 来减少服务器内存占用. 这篇主要写一下如何使用python对redis的基本操作, 及使用多种方式设置键的过期时间. 这些方式允许你为键设置一个时间限制，一旦过期，Redis将自动删除该键。

**安装**

> pip3.7 install redis

**基本操作**

具体使用及注释直接看示例代码

# -\*- coding: utf-8 -\*-  
# @Author: Mehaei  
# @Date: 2023-09-09 12:53:24  
# @Last Modified by: Mehaei  
# @Last Modified time: 2023-09-09 13:59:58  
  
import time  
import redis  
# 连接到本地Redis服务器，默认端口是6379  
redis\_client = redis.Redis(host='localhost', port=6379, db=0)  
  
# 设置键值对  
redis\_client.set('my\_key', 'Hello, Redis!')  
  
# 获取键的值  
value = redis\_client.get('my\_key')  
print(value.decode('utf-8')) # 解码并打印值  
  
# 执行列表操作  
redis\_client.lpush('my\_list', 'item1', 'item2', 'item3')  
  
# 获取列表元素  
items = redis\_client.lrange('my\_list', 0, -1)  
for item in items:  
    print(item.decode('utf-8'))  
  
# 哈希操作  
redis\_client.hset('my\_hash', 'field1', 'value1')  
redis\_client.hset('my\_hash', 'field2', 'value2')  
  
# 获取哈希值  
field\_value = redis\_client.hget('my\_hash', 'field1')  
print(field\_value.decode('utf-8'))  
  
# 删除键  
redis\_client.delete('my\_key')  
redis\_client.delete('my\_list')  
redis\_client.delete('my\_hash')

![](/images/4c991a2f/2.png)

**设置键的过期操作**

使用 expire 命令

# 设置键my\_key的值为Hello, Redis!  
redis\_client.set('my\_key', 'Hello, Redis!')  
# 使用EXPIRE命令设置键my\_key的过期时间为2秒  
redis\_client.expire('my\_key', 2)  
  
print(redis\_client.get("my\_key"))  
time.sleep(2)  
# 2秒钟后获取  
print(redis\_client.get("my\_key"))  
"""  
输出  
b'Hello, Redis!'  
None  
[Finished in 2.1s]  
"""

使用 set 命令的 ex 参数

# 设置键my\_key的值为Hello, Redis!，并将过期时间设置为2秒  
redis\_client.set('my\_key', 'Hello, Redis!', ex=2)  
print(redis\_client.get("my\_key"))  
  
time.sleep(2)  
# 2秒钟后获取  
print(redis\_client.get("my\_key"))  
"""  
输出  
b'Hello, Redis!'  
None  
[Finished in 2.1s]  
"""

使用 setex 命令

# 设置键my\_key的值为Hello, Redis!，并将过期时间设置为2秒  
redis\_client.setex('my\_key', 2, 'Hello, Redis!')  
print(redis\_client.get("my\_key"))  
  
time.sleep(2)  
# 2秒钟后获取  
print(redis\_client.get("my\_key"))  
"""  
输出  
b'Hello, Redis!'  
None  
[Finished in 2.1s]  
"""

使用 persist 命令来移除过期时间

# 设置键my\_key的值为Hello, Redis!，并将过期时间设置为2秒  
redis\_client.set('my\_key', 'Hello, Redis!', ex=2)  
# 移除键my\_key的过期时间  
redis\_client.persist('my\_key')  
print(redis\_client.get("my\_key"))  
  
time.sleep(2)  
# 2秒钟后获取  
print(redis\_client.get("my\_key"))  
"""  
输出  
b'Hello, Redis!'  
b'Hello, Redis!'  
[Finished in 2.1s]  
"""

不设置过期时间，让键永不过期，默认就是永不过期

# 设置键my\_key的值为Hello, Redis!，让其永不过期  
redis\_client.set('my\_key', 'Hello, Redis!')  
print(redis\_client.get("my\_key"))  
  
time.sleep(2)  
# 2秒钟后获取  
print(redis\_client.get("my\_key"))  
"""  
输出  
b'Hello, Redis!'  
b'Hello, Redis!'  
[Finished in 2.1s]  
"""

**完了!!!**

        这些是使用python对redis的基本操作及设置Redis键过期时间的几种方式，可以根据你的需求选择合适的方式来管理和控制Redis中的数据。无论哪种方式，Redis都会在过期时间到达时自动删除相应的键。

一直在努力, 记得点个在看哦!