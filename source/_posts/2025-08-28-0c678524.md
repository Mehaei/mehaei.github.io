---
layout:     post
title:      "Ubuntu ç¦»çº¿å®‰è£…è½¯ä»¶åŠä¾èµ–çš„å®Œæ•´æ–¹æ³•ï¼ˆå®¹å™¨æ‰“åŒ… + æœ¬åœ°æºï¼‰"
subtitle:   
date:       2025-08-28
author:     èƒ–èƒ–å¾ˆç˜¦
thumbnail:  /images/0c678524/thumbnail.png
catalog: true
categories: #ubuntu
original_url: https://mp.weixin.qq.com/s/YeA6_0GU6FkPdfdE0vROTA
tags:
    - #ubuntu
---

# ğŸš€ å‡†å¤‡å¼€å§‹å§ï¼

åœ¨ç”Ÿäº§ç¯å¢ƒã€å†…ç½‘ç¯å¢ƒæˆ–è€…æ— æ³•è”ç½‘çš„æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦Â **ç¦»çº¿å®‰è£…è½¯ä»¶**ã€‚  
è¿™ç¯‡æ–‡ç« æ•™ä½ ä»é›¶å¼€å§‹ï¼š  
ğŸ‘‰ å¦‚ä½•åœ¨è”ç½‘ç¯å¢ƒä¸­ä¸‹è½½è½¯ä»¶åŒ…åŠä¾èµ–  
ğŸ‘‰ å¦‚ä½•æ‹·è´åˆ°ç¦»çº¿æœºå™¨  
ğŸ‘‰ å¦‚ä½•é¡ºåˆ©å®‰è£…å¹¶è§£å†³ä¾èµ–é—®é¢˜

---

## ğŸ”¹ ä¸€ã€å‡†å¤‡ä¸€å°å¯ä»¥è”ç½‘çš„åŒç‰ˆæœ¬ Ubuntu

ä¸ºäº†é¿å…ä¾èµ–ä¸ä¸€è‡´ï¼Œä¸‹è½½å’Œå®‰è£…å¿…é¡»ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ Ubuntuã€‚

å¦‚æœæœ¬åœ°ä¸æ˜¯ Ubuntuï¼Œå¯ä»¥åœ¨Â **Docker**Â ä¸­ä¸´æ—¶æ‹‰ä¸€ä¸ª Ubuntu å®¹å™¨ä½œä¸ºä¸‹è½½æœºï¼š

```
docker run -it ubuntu:20.04 bash  
apt-get update  
apt-get install -y apt-utils apt-rdepends dpkg-dev
```

è¿™æ ·ä½ å°±æœ‰äº†ä¸€ä¸ªå¹²å‡€çš„ Ubuntu 20.04 ç¯å¢ƒã€‚

---

## ğŸ”¹ äºŒã€ä¸¤ç§ä¸‹è½½æ–¹å¼åŠåŒºåˆ«

### 1.Â `apt-get install --download-only`

ä¸‹è½½è½¯ä»¶åŠä¾èµ–åˆ°ç³»ç»Ÿç¼“å­˜ç›®å½•Â `/var/cache/apt/archives/`ï¼Œä½†ä¸ä¼šå®‰è£…ã€‚

```
sudoÂ apt-get install --download-only -y make  
lsÂ /var/cache/apt/archives/
```

ğŸ‘‰ ä¼˜ç‚¹ï¼šç®€å•ï¼ŒAPT è‡ªåŠ¨å¤„ç†ä¾èµ–ã€‚  
ğŸ‘‰ ç¼ºç‚¹ï¼šéœ€è¦ä»ç¼“å­˜ç›®å½•æ‰‹åŠ¨æ‹·è´åŒ…ï¼Œä¸é›†ä¸­ã€‚

---

### 2.Â `apt-get download + apt-rdepends`

æ˜¾å¼åˆ—å‡ºä¾èµ–å¹¶é€ä¸ªä¸‹è½½åˆ°å½“å‰ç›®å½•ã€‚

```
mkdirÂ ~/deb-packages &&Â cdÂ ~/deb-packages  
apt-get download $(apt-rdepends make | grep -vÂ "^ ")
```

ğŸ‘‰ ä¼˜ç‚¹ï¼šæ‰€æœ‰Â `.deb`Â æ–‡ä»¶éƒ½åœ¨ä¸€ä¸ªç›®å½•é‡Œï¼Œæ–¹ä¾¿æ‰“åŒ…ã€‚  
ğŸ‘‰ ç¼ºç‚¹ï¼šå¯èƒ½ä¼šå¤šä¸‹å¯é€‰ä¾èµ–ã€‚

---

## ğŸ”¹ ä¸‰ã€æ‰“åŒ…å¹¶æ‹·è´åˆ°ç¦»çº¿æœºå™¨

åœ¨å®¹å™¨æˆ–è”ç½‘ç¯å¢ƒä¸­ï¼Œä¸‹è½½å¥½çš„åŒ…æ”¾åœ¨ç›®å½•Â `~/deb-packages/`ã€‚

### 1. å‹ç¼©æ‰“åŒ…

```
tar -czvf deb-packages.tar.gz ~/deb-packages
```

### 2. æ‹·è´åˆ°è™šæ‹Ÿæœº / ç¦»çº¿æœºå™¨

* å¦‚æœæ˜¯Â **å®¿ä¸»æœº â†” è™šæ‹Ÿæœº**ï¼Œå¯ä»¥ç”¨Â `scp`ï¼š

  ```
  scp deb-packages.tar.gz user@vm-ip:/opt/
  ```
* å¦‚æœæ˜¯Â **Docker å®¹å™¨ â†’ å®¿ä¸»æœº**ï¼š

  ```
  dockerÂ cpÂ <container_id>:/root/deb-packages.tar.gz .
  ```
* å†é€šè¿‡ U ç›˜ã€å…±äº«ç›®å½•ç­‰æ–¹å¼å¸¦åˆ°ç¦»çº¿æœºå™¨ã€‚

### 3. è§£å‹

åœ¨ç¦»çº¿æœºå™¨ä¸Šï¼š

```
cdÂ /opt/  
tar -xzvf deb-packages.tar.gz  
cdÂ deb-packages
```

---

## ğŸ”¹ å››ã€ç¦»çº¿å®‰è£…è½¯ä»¶åŠä¾èµ–

### æ–¹æ³• 1ï¼šç›´æ¥ç”¨Â `dpkg`

```
sudoÂ dpkg -i *.deb  
sudoÂ apt-get install -f Â Â # è‡ªåŠ¨ä¿®å¤ä¾èµ–
```

### æ–¹æ³• 2ï¼ˆæ¨èï¼‰ï¼šå»ºç«‹æœ¬åœ°ä»“åº“

è¿™æ · APT ä¼šè‡ªåŠ¨è§£å†³å®‰è£…é¡ºåºï¼Œæ¯”Â `dpkg`Â ç¨³å®šã€‚

```
# å®‰è£…å·¥å…·  
sudoÂ apt-get install -y dpkg-dev  
  
# åœ¨ deb åŒ…ç›®å½•ç”Ÿæˆç´¢å¼•  
dpkg-scanpackages . /dev/null | gzip -9c > Packages.gz  
  
# æ·»åŠ æœ¬åœ°æº  
echoÂ "deb [trusted=yes] file:/opt/deb-packages ./"Â |Â sudoÂ teeÂ /etc/apt/sources.list.d/local.list  
  
# æ›´æ–°ç´¢å¼•  
sudoÂ apt-get update  
  
# å®‰è£…è½¯ä»¶ï¼ˆAPT è‡ªåŠ¨å¤„ç†ä¾èµ–ï¼‰  
sudoÂ apt-get install make
```

---

## ğŸ”¹ äº”ã€æ€»ç»“

1. **ä¸‹è½½æ–¹å¼**ï¼š

* ä¸´æ—¶ä½¿ç”¨ â†’Â `apt-get install --download-only`
* æ‰“åŒ…å¸¦èµ° â†’Â `apt-get download $(apt-rdepends â€¦)`

2. **ä¼ è¾“æ–¹å¼**ï¼š

* å®¹å™¨ â†’ å®¿ä¸»æœº â†’ ç¦»çº¿æœºï¼Œå¯ä»¥ç”¨Â `docker cp`ã€`scp`ã€U ç›˜ã€‚

3. **å®‰è£…æ–¹å¼**ï¼š

* ç®€å•ç›´æ¥ â†’Â `dpkg -i *.deb && apt-get install -f`
* æ›´ä¼˜é›… â†’ æ­å»ºæœ¬åœ°ä»“åº“ï¼Œ`apt-get install`Â è‡ªåŠ¨è§£å†³ä¾èµ–ã€‚

è¿™æ ·ï¼Œä¸ç®¡ä½ çš„æœåŠ¡å™¨æ˜¯å¦è”ç½‘ï¼Œéƒ½èƒ½é¡ºåˆ©å®Œæˆè½¯ä»¶å®‰è£… ğŸš€ã€‚

---